import sys

def check_password_in_rockyou(password, file_path):
    try:
        with open(file_path, 'r', encoding='latin-1') as file:
            for line in file:
                if line.strip() == password:
                    return True
        return False
    except FileNotFoundError:
        print(f"The file does not exist.")
        return False

def contains_uppercase(password):
    for char in password:
        if char.isupper():
            return True
    return False

def contains_lowercase(password):
    for char in password:
        if char.islower():
            return True
    return False

def contains_digit(password):
    for char in password:
        if char.isdigit():
            return True
    return False

def contains_special_character(password):
    special_characters = "!@#$%^&*()-_+=<>?/|\\{}[]~`"
    for char in password:
        if char in special_characters:
            return True
    return False

def has_minimum_length(password, length=12):
    return len(password) >= length

if __name__ == "__main__":
    if len(sys.argv) != 2:
        print("Usage: python check_password.py <password>")
    else:
        password = sys.argv[1]
        file_path_1 = '/script/script_LightningMalware/src_analyze/rockyou_1.txt'
        file_path_2 = '/script/script_LightningMalware/src_analyze/rockyou_2.txt'
        print("------------- CHECK PASSWORD ------------\n")
        
        if not has_minimum_length(password):
            print("The password must contain at least 12 characters.")
        if not contains_uppercase(password):
            print("The password must contain at least one uppercase letter.")
        if not contains_lowercase(password):
            print("The password must contain at least one lowercase letter.")
        if not contains_digit(password):
            print("The password must contain at least one digit.")
        if not contains_special_character(password):
            print("The password must contain at least one special character.")

        if check_password_in_rockyou(password, file_path_1):
            print("This password is already known to hackers and can be easily cracked by brute force.")
        elif check_password_in_rockyou(password, file_path_2):
            print("This password is already known to hackers and can be easily cracked by brute force.")
        else:
            print("The password isn't know to hackers.")
