import sys

def check_password_in_rockyou(password, file_path):
    with open('/tmp/scan_result_passwd.txt', 'a') as f:
        try:
            with open(file_path, 'r', encoding='latin-1') as file:
                for line in file:
                    if line.strip() == password:
                        return True
            return False
        except FileNotFoundError:
            f.write(f"The file does not exist.")
            return False

def contains_uppercase(password):
    for char in password:
        if char.isupper():
            return True
    return False

def contains_lowercase(password):
    for char in password:
        if char.islower():
            return True
    return False

def contains_digit(password):
    for char in password:
        if char.isdigit():
            return True
    return False

def contains_special_character(password):
    special_characters = "!@#$%^&*()-_+=<>?/|\\{}[]~`"
    for char in password:
        if char in special_characters:
            return True
    return False

def has_minimum_length(password, length=12):
    return len(password) >= length

if __name__ == "__main__":
    with open('/tmp/scan_result.txt', 'a') as f:
        if len(sys.argv) != 2:
            f.write("Usage: python check_password.py <password>")
        else:
            password = sys.argv[1]
            file_path_1 = '/script/script_LightningMalware/src_analyze/rockyou_1.txt'
            file_path_2 = '/script/script_LightningMalware/src_analyze/rockyou_2.txt'
            
            f.write("\n\n------------- CHECK PASSWORD ------------\n")
        
            if not has_minimum_length(password):
                f.write("\nThe password must contain at least 12 characters.")
            if not contains_uppercase(password):
                f.write("\nThe password must contain at least one uppercase letter.")
            if not contains_lowercase(password):
                f.write("\nThe password must contain at least one lowercase letter.")
            if not contains_digit(password):
                f.write("\nThe password must contain at least one digit.")
            if not contains_special_character(password):
                f.write("\nThe password must contain at least one special character.")

            if check_password_in_rockyou(password, file_path_1):
                f.write("\nThis password is already known to hackers and can be easily cracked by brute force.")
            elif check_password_in_rockyou(password, file_path_2):
                f.write("\nThis password is already known to hackers and can be easily cracked by brute force.")
            else:
                f.write("\nThe password isn't know to hackers.")
